<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Invoice - <%= transactionId %></title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Arial", sans-serif;
        background-color: #f8f9fa;
        color: #333;
        line-height: 1.6;
      }

      .invoice-container {
        max-width: 800px;
        margin: 20px auto;
        background: white;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
        border-radius: 8px;
        overflow: hidden;
      }

      .header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 30px;
        text-align: center;
      }

      .header h1 {
        font-size: 2.5rem;
        margin-bottom: 10px;
        font-weight: 300;
      }

      .header p {
        font-size: 1.1rem;
        opacity: 0.9;
      }

      .invoice-info {
        display: flex;
        justify-content: space-between;
        padding: 30px;
        background-color: #f8f9fa;
        border-bottom: 1px solid #e9ecef;
      }

      .invoice-details,
      .customer-details {
        flex: 1;
      }

      .invoice-details h3,
      .customer-details h3 {
        color: #495057;
        margin-bottom: 15px;
        font-size: 1.2rem;
        border-bottom: 2px solid #667eea;
        padding-bottom: 5px;
        display: inline-block;
      }

      .detail-row {
        margin: 8px 0;
        font-size: 0.95rem;
      }

      .detail-label {
        font-weight: 600;
        color: #6c757d;
        min-width: 120px;
        display: inline-block;
      }

      .detail-value {
        color: #495057;
      }

      .items-section {
        padding: 30px;
      }

      .items-header {
        background-color: #f8f9fa;
        padding: 15px;
        border-radius: 5px;
        margin-bottom: 20px;
      }

      .items-header h3 {
        color: #495057;
        font-size: 1.3rem;
      }

      .item-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px 0;
        border-bottom: 1px solid #e9ecef;
      }

      .item-details {
        flex: 1;
      }

      .item-name {
        font-size: 1.1rem;
        font-weight: 600;
        color: #495057;
        margin-bottom: 5px;
      }

      .item-description {
        color: #6c757d;
        font-size: 0.9rem;
      }

      .item-price {
        font-size: 1.2rem;
        font-weight: 600;
        color: #28a745;
      }

      .total-section {
        background-color: #f8f9fa;
        padding: 30px;
        border-top: 2px solid #667eea;
      }

      .total-row {
        display: flex;
        justify-content: space-between;
        margin: 10px 0;
        font-size: 1.1rem;
      }

      .total-final {
        font-size: 1.4rem;
        font-weight: 700;
        color: #495057;
        border-top: 2px solid #667eea;
        padding-top: 15px;
        margin-top: 15px;
      }

      .status-badge {
        display: inline-block;
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 0.85rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .status-completed {
        background-color: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
      }

      .status-pending {
        background-color: #fff3cd;
        color: #856404;
        border: 1px solid #ffeaa7;
      }

      .status-failed {
        background-color: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
      }

      .status-cancelled {
        background-color: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
      }

      .footer {
        text-align: center;
        padding: 30px;
        background-color: #343a40;
        color: white;
      }

      .footer p {
        margin: 5px 0;
        opacity: 0.8;
      }

      .company-info {
        margin-bottom: 20px;
      }

      .company-name {
        font-size: 1.5rem;
        font-weight: 600;
        color: #667eea;
        margin-bottom: 5px;
      }

      @media (max-width: 768px) {
        .invoice-container {
          margin: 10px;
        }

        .invoice-info {
          flex-direction: column;
          gap: 20px;
        }

        .header h1 {
          font-size: 2rem;
        }

        .item-row {
          flex-direction: column;
          align-items: flex-start;
          gap: 10px;
        }

        .total-row {
          font-size: 1rem;
        }

        .total-final {
          font-size: 1.2rem;
        }
      }
    </style>
  </head>
  <body>
    <div class="invoice-container">
      <!-- Header -->
      <div class="header">
        <h1>INVOICE</h1>
        <p>Transaction ID: <%= transactionId %></p>
      </div>

      <!-- Invoice Information -->
      <div class="invoice-info">
        <div class="invoice-details">
          <h3>Invoice Details</h3>
          <div class="detail-row">
            <span class="detail-label">Invoice Date:</span>
            <span class="detail-value"
              ><%= new Date(createdAt).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })
              %></span
            >
          </div>
          <div class="detail-row">
            <span class="detail-label">Transaction ID:</span>
            <span class="detail-value"><%= transactionId %></span>
          </div>
          <div class="detail-row">
            <span class="detail-label">Status:</span>
            <span class="status-badge status-<%= status.toLowerCase() %>"><%= status %></span>
          </div>
        </div>

        <div class="customer-details">
          <h3>Customer Information</h3>
          <div class="detail-row">
            <span class="detail-label">Name:</span>
            <span class="detail-value"><%= user.firstName %> <%= user.lastName %></span>
          </div>
          <div class="detail-row">
            <span class="detail-label">Email:</span>
            <span class="detail-value"><%= user.email %></span>
          </div>
          <% if (user.phoneNumber) { %>
          <div class="detail-row">
            <span class="detail-label">Phone:</span>
            <span class="detail-value"><%= user.phoneNumber %></span>
          </div>
          <% } %> <% if (user.address) { %>
          <div class="detail-row">
            <span class="detail-label">Address:</span>
            <span class="detail-value"><%= user.address %></span>
          </div>
          <% } %>
        </div>
      </div>

      <!-- Items Section -->
      <div class="items-section">
        <div class="items-header">
          <h3>Course Purchase Details</h3>
        </div>

        <div class="item-row">
          <div class="item-details">
            <div class="item-name"><%= course.name %></div>
            <div class="item-description">
              <%= course.description.substring(0, 100) %><%= course.description.length > 100 ? '...' : '' %>
            </div>
            <div class="item-description">
              <strong>Duration:</strong> <%= course.courseDuration %> | <strong>Type:</strong> <%= course.type %> |
              <strong>Certificate:</strong> <%= course.certificate ? 'Included' : 'Not Included' %>
            </div>
          </div>
          <div class="item-price">$<%= (amount / 100).toFixed(2) %></div>
        </div>
      </div>

      <!-- Total Section -->
      <div class="total-section">
        <div class="total-row">
          <span>Subtotal:</span>
          <span>$<%= (amount / 100).toFixed(2) %></span>
        </div>
        <% if (course.discount && course.discount > 0) { %>
        <div class="total-row">
          <span>Discount (<%= course.discount %>%):</span>
          <span>-$<%= ((course.price * course.discount / 100) / 100).toFixed(2) %></span>
        </div>
        <% } %>
        <div class="total-row">
          <span>Tax (0%):</span>
          <span>$0.00</span>
        </div>
        <div class="total-row total-final">
          <span>Total Amount:</span>
          <span>$<%= (amount / 100).toFixed(2) %></span>
        </div>
      </div>

      <!-- Footer -->
      <div class="footer">
        <div class="company-info">
          <div class="company-name">SHIKHI</div>
          <p>Your Learning Management System</p>
        </div>
        <p>Thank you for your purchase!</p>
        <p>If you have any questions, please contact our support team.</p>
        <p style="font-size: 0.8rem; margin-top: 15px">
          This invoice was generated automatically on <%= new Date().toLocaleDateString('en-US', { year: 'numeric',
          month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit' }) %>
        </p>
      </div>
    </div>
  </body>
</html>
